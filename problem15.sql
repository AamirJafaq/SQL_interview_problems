
-- UBER Asked Questions 

-- Create drivers table
DROP TABLE IF EXISTS drivers;
CREATE TABLE drivers (
    driver_id INT PRIMARY KEY,
    driver_name VARCHAR(100),
    driver_rating FLOAT,
    join_date DATE
);

-- Create passengers table
DROP TABLE IF EXISTS passenger;
CREATE TABLE passengers (
    passenger_id INT PRIMARY KEY,
    passenger_name VARCHAR(100),
    passenger_rating FLOAT,
    join_date DATE
);

-- Create rides table
DROP TABLE IF EXISTS rides;
CREATE TABLE rides (
    ride_id INT PRIMARY KEY,
    driver_id INT,
    passenger_id INT,
    ride_date DATE,
    ride_distance FLOAT,
    ride_cost FLOAT,
    FOREIGN KEY (driver_id) REFERENCES drivers(driver_id),
    FOREIGN KEY (passenger_id) REFERENCES passengers(passenger_id)
);

-- Insert sample data into drivers table
INSERT INTO drivers (driver_id, driver_name, driver_rating, join_date) VALUES
(1, 'John Doe', 4.8, '2022-01-15'),
(2, 'Jane Smith', 4.5, '2021-07-22'),
(3, 'Bob Johnson', 4.9, '2020-11-30');

-- Insert sample data into passengers table
INSERT INTO passengers (passenger_id, passenger_name, passenger_rating, join_date) VALUES
(1, 'Alice Brown', 4.7, '2022-03-11'),
(2, 'Charlie Green', 4.6, '2021-09-19'),
(3, 'David White', 4.8, '2020-05-25');

-- Insert sample data into rides table
INSERT INTO rides (ride_id, driver_id, passenger_id, ride_date, ride_distance, ride_cost) VALUES
(1, 1, 1, '2023-06-01', 12.5, 25.0),
(2, 2, 2, '2023-06-02', 8.0, 16.0),
(3, 3, 3, '2023-06-03', 10.2, 20.4),
(4, 1, 2, '2023-06-04', 7.5, 15.0),
(5, 2, 3, '2023-06-05', 15.0, 30.0),
(6, 2, 3, '2023-06-07', 15.0, 30.0);


-- Question 1: Find the driver with the highest Rating (return driver_name and rating)
SELECT driver_name, driver_rating
FROM drivers
ORDER BY driver_rating DESC
LIMIT 1;


-- Question 2: Calculate the total revenue generated by each driver (return driver_name, id, revenue)
SELECT r.driver_id, d.driver_name, sum(r.ride_cost) AS total_revenue
FROM rides AS r
LEFT JOIN drivers AS d ON d.driver_id=r.driver_id
GROUP BY 1, 2;


-- Question 3: Find the passenger with the highest number of rides (return passenger_name, id, no of rides)
SELECT p.passenger_id, p.passenger_name, count(r.ride_id) AS total_rides
FROM rides AS r
LEFT JOIN passengers AS p ON p.passenger_id=r.passenger_id
GROUP BY 1, 2
ORDER BY total_rides DESC
LIMIT 1;


-- Question 4: Identify the most frequent ride distance (return ride_distance and number of frequency)
SELECT ride_distance, count(ride_distance) AS ride_freq
FROM rides
GROUP BY 1
ORDER BY ride_freq DESC
LIMIT 1;


